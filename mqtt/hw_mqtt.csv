name,player1,player2,player3
solution,[nl]  client.subscribe('battle/action');[nl]  client.subscribe('battle/online');[nl],"[nl]    const payload = {[nl]      from: PLAYER_NAME,[nl]      to: 'Boss',[nl]      damage: attack_value[nl]    };[nl]    client.publish('battle/action', JSON.stringify(payload));[nl]",[nl]  if (topic === 'battle/action') {[nl]    [nl]    const roundInfo = JSON.parse(msg);[nl]    if (roundInfo.round !== undefined) {[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}[nl]`);[nl]      // æ ¹æ“šå›åˆæ•¸å’Œè¡€é‡æ±ºå®šæ˜¯å¦çµæŸéŠæˆ²æˆ–ç¹¼çºŒ[nl]      if (roundInfo.boss_hp <= 0) {[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);[nl]      }[nl]      client.end(); // çµæŸ MQTT é€£ç·š[nl]    }[nl]  }[nl]
ä½•å˜‰æŸš,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const Info = {
[nl]      to: 'Boss',
[nl]      from: PLAYER_NAME,
[nl]      damage: attack_value
[nl]    };
[nl]
[nl]    client.publish('battle/action',JSON.stringify(Info));
[nl]    
[nl]","if(topic === 'battle/action'){
[nl]    const action = JSON.parse(message);
[nl]    const round = action.round;
[nl]    const boss_hp = action.boss_hp;
[nl]    if(round != undefined){
[nl]      console.log(`[ å›åˆ ${round} ]: Boss å‰©é¤˜è¡€é‡ ${boss_hp}\n`)
[nl]      if(boss_hp <= 0){
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!\n`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
ä½™é‡‡å¬™,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackData = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]
[nl]    client.publish('battle/action', JSON.stringify(attackData));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  if (topic === 'battle/action') {
[nl]    const bossUpdateMsg = JSON.parse(msg);
[nl]
[nl]    if (bossUpdateMsg.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${bossUpdateMsg.round} ]: Boss å‰©é¤˜è¡€é‡ ${bossUpdateMsg.boss_hp}`);
[nl]
[nl]      if (bossUpdateMsg.boss_hp <= 0) {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();  // çµæŸMQTTé€£ç·š
[nl]      }
[nl]    }
[nl]  }
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
å‚…å­çˆ,"client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attack = {
[nl]      damage: `${attack_value}`,
[nl]      to: 'Boss',
[nl]      from: `${PLAYER_NAME}`,
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attack));","if (topic === 'battle/action') {
[nl]    const data = JSON.parse(msg);
[nl]    const round = data.round;
[nl]    const boss_hp = data.boss_hp;
[nl]    
[nl]    if (round != undefined) {
[nl]      console.log(`[ å›åˆ ${round} ]: Boss å‰©é¤˜è¡€é‡ ${boss_hp}`);
[nl]      
[nl]      if (boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]      }
[nl]      client.end(); 
[nl]    }
[nl]  }
[nl]  
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
å‚…éˆºå©·,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","publish_action = {
[nl]      from: `${PLAYER_NAME}`,
[nl]      to: ""Boss"",
[nl]      damage: `${attack_value}`
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(publish_action));
[nl]    return;","const action = JSON.parse(msg);
[nl]  if (topic === 'battle/action') {
[nl]    if (action.round != undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]      }
[nl]      client.end(); 
[nl]    }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
åŠ‰ä¿®ç¶­,,,
åŠ‰æ¥šå©·,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","const attackInfo = {
[nl]      from: PLAYER_NAME,
[nl]      to: ""Boss"",
[nl]      damage: attack_value
[nl]    }
[nl]
[nl]    client.publish('battle/action', JSON.stringify(attackInfo));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if(topic === 'battle/action'){
[nl]    const info = JSON.parse(msg);
[nl]    if(info.round != undefined){
[nl]      console.log(`[ ç¬¬ ${info.round} å›åˆ ]`);
[nl]      console.log(`Boss å‰©é¤˜è¡€é‡ ${info.boss_hp}`);
[nl]
[nl]      //bossé¼ æ‰
[nl]      if(info.boss_hp <= 0){
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]      //ç¹¼çºŒæ”»æ“Š
[nl]      else{
[nl]        const attackInfo = {
[nl]          from: PLAYER_NAME,
[nl]          to: ""Boss"",
[nl]          damage: attack_value
[nl]        }
[nl]
[nl]        client.publish('battle/action', JSON.stringify(attackInfo));
[nl]      }
[nl]    }
[nl]  }"
åŠ‰ç™½,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attack = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attack));","if(topic === 'battle/action'){
[nl]    try{
[nl]      const data = JSON.parse(msg);
[nl]
[nl]      if(data.round !== undefined && data.boss_hp !== undefined){
[nl]        console.log(`\n[ ç¬¬ ${data.round} å›åˆ ]: Boss å‰©é¤˜è¡€é‡ ${data.boss_hp}`);
[nl]
[nl]        if(data.boss_hp <= 0){
[nl]          console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]          client.end();
[nl]        }else{
[nl]          //ATTACKä¸‹ä¸€å›åˆ
[nl]          setTimeout(() => {
[nl]            const attack = {
[nl]              from: PLAYER_NAME,
[nl]              to: 'Boss',
[nl]              damage: attack_value
[nl]            };
[nl]            client.publish('battle/action', JSON.stringify(attack));
[nl]          }, 1000);
[nl]        }
[nl]      }
[nl]    } catch (err){ console.warn('æ”¶åˆ°é JSON æˆ–éŒ¯èª¤æ ¼å¼çš„è¨Šæ¯ï¼Œå·²ç•¥éï¼š', msg); }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
åŠ‰ç§‰æ²»,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","[nl]    const attackInfo = {
[nl]      to : 'Boss',
[nl]      from : PLAYER_NAME,
[nl]      damage : attack_value
[nl]    };
[nl]
[nl]    client.publish('battle/action', JSON.stringify(attackInfo));
[nl]","[nl]  if (topic === 'battle/action') 
[nl]  {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined)
[nl]    {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]
[nl]      if (action.boss_hp <= 0) 
[nl]      {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]
[nl]      client.publish('battle/online');
[nl]    }
[nl]  }
[nl]
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
å³å”¯ç¦,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackmsg = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]
[nl]    client.publish('battle/action', JSON.stringify(attackmsg));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if(topic === 'battle/action'){
[nl]    const response = JSON.parse(msg);
[nl]    if(response.round !== undefined && response.boss_hp !== undefined){
[nl]      console.log(`[ å›åˆ ${response.round} ]: Boss å‰©é¤˜è¡€é‡ ${response.boss_hp}`);
[nl]      if(response.boss_hp <= 0){
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•—!!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]"
å³å§µè±,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackInfo = {
[nl]		to: ""Boss"",
[nl]		damage: attack_value,
[nl]		from: PLAYER_NAME
[nl]	};
[nl]	client.publish('battle/action', JSON.stringify(attackInfo));","if(topic ==='battle/action'){
[nl]	const reply = JSON.parse(msg);
[nl]	if(reply.round != undefined){
[nl]		console.log(`[ å›åˆ ${reply.round} ]: Boss å‰©é¤˜è¡€é‡ ${reply.boss_hp}`);
[nl]	}
[nl]	if(reply.boss_hp <=0 ){
[nl]		console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);	
[nl]		client.end();
[nl]	}
[nl]	const attackInfo = {
[nl]		to: ""Boss"",
[nl]		damage: attack_value,
[nl]		from: PLAYER_NAME
[nl]	};
[nl]  }
[nl]  
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
å³å²±èŠ¸,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","const payload = {
[nl]		  to: 'Boss',
[nl]		  from: PLAYER_NAME,
[nl]  		damage: attack_value
[nl]		}
[nl]   	client.publish('battle/action', JSON.stringify(payload));
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]	if (topic === 'battle/action'){
[nl]		const data = JSON.parse(msg);
[nl]		const round = data.round
[nl]		const boss_hp = data.boss_hp;
[nl]		
[nl]		if (round !== undefined) {
[nl]      	console.log(`[ å›åˆï¼š ${round} ]: Boss å‰©é¤˜è¡€é‡ ${boss_hp}`);
[nl]      	if (boss_hp <= 0) {
[nl]        	console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        	client.end();
[nl]      }
[nl]    }
[nl]	}"
å³ç®å˜‰,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackInfo = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackInfo));
[nl]    // client.end(); // çµæŸ MQTT é€£ç·š","if (topic === 'battle/action') {
[nl]    const actionInfo = JSON.parse(msg);
[nl]    const round = actionInfo.round;
[nl]    const boss_hp = actionInfo.boss_hp;
[nl]
[nl]    if (round !== undefined) {
[nl]      console.log(`[ å›åˆ ${round} ]: Boss å‰©é¤˜è¡€é‡ ${boss_hp}`);
[nl]
[nl]      if (boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
å‘¨æ˜ è¾°,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]
[nl]","const attack = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]
[nl]    client.publish('battle/action', JSON.stringify(attack));
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if ( topic === 'battle/action') {
[nl]    const response = JSON.parse(msg);
[nl]    
[nl]    if ( response.round !== undefined) {
[nl]        console.log(`[ å›åˆ ${response.round} ]: Boss å‰©é¤˜è¡€é‡ ${response.boss_hp}`);
[nl]        if ( response.boss_hp <= 0){
[nl]          console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`)
[nl]          client.end(); // çµæŸ MQTT é€£ç·š
[nl]        }
[nl]        else {
[nl]          // å¦‚æœ Boss æ²’æ­»ï¼Œè‡ªå‹•å†æ¬¡æ”»æ“Š
[nl]          const attack = {
[nl]            from: PLAYER_NAME,
[nl]            to: 'Boss',
[nl]            damage: attack_value
[nl]          };
[nl]          client.publish('battle/action', JSON.stringify(attack));
[nl]        }
[nl]
[nl]      }
[nl]
[nl]  }
[nl]"
å”æ¹˜æ€¡,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackAction = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackAction));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action'){
[nl]  	const action = JSON.parse(msg);
[nl]    if(action.round !== undefined){
[nl]	  console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]	  if(action.boss_hp <=0){
[nl]	    console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]		client.end();
[nl]	  }
[nl]	  else{
[nl]	    console.log(`${PLAYER_NAME} å° Boss ç™¼èµ·æ”»æ“Šï¼Œé€ æˆ ${attack_value} å‚·å®³`);
[nl]	  	const nextAttack = {
[nl]          from: PLAYER_NAME,
[nl]    	  to: 'Boss',
[nl]          damage: attack_value
[nl]        };
[nl]	    client.publish('battle/action', JSON.stringify(nextAttack));
[nl]	  }
[nl]	}
[nl]  }"
åš´è²é ,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const action = {
[nl]        to: 'Boss',
[nl]        from: PLAYER_NAME,
[nl]        damage: attack_value
[nl]      };
[nl]    client.publish('battle/action', JSON.stringify(action));","if (topic === 'battle/action') {
[nl]    const roundInfo = JSON.parse(msg);
[nl]    if (roundInfo.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]      if (roundInfo.boss_hp <= 0) {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      }
[nl]    }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
å°¤æ•ç±³èŒ²å¤ ,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","[nl]    const attackInfo = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]
[nl]    client.publish('battle/action', JSON.stringify(attackInfo));
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]
[nl]  if (topic == 'battle/action') {
[nl]    const round = JSON.parse(msg);
[nl]
[nl]    if (round.round != undefined) {
[nl]      console.log(`[ å›åˆ ${round.round} ]: Boss å‰©é¤˜è¡€é‡ ${round.boss_hp}`);
[nl]
[nl]      if (round.boss_hp <= 0) {
[nl]        console.log(""æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!"");
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]"
å»–å‰å“²,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","// ç™¼å¸ƒæ”»æ“Šè¨Šæ¯çµ¦ Boss
[nl]    const attackMsg = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackMsg));
[nl]
[nl]    return; // è™•ç†å®Œä¸Šç·šè¨Šæ¯å°±çµæŸé€™è¼ª","// ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  // âœ… å¦‚æœæ˜¯ Boss å›æ‡‰çš„è¨Šæ¯
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    
[nl]    //åˆ¤æ–·æ˜¯èª°ç™¼å‡ºçš„actionï¼Œå› ç‚ºä¹Ÿæœƒæ”¶åˆ°è‡ªå·±çš„
[nl]    if (action.round !== undefined) {
[nl]      console.log(`\n[ ç¬¬ ${action.round} å›åˆ ]`);
[nl]      console.log(`Boss å—åˆ° Player çš„æ”»æ“Šï¼Œæå¤± 715 HPï¼Œå‰©é¤˜ HPï¼š${action.boss_hp}`);
[nl]
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸé€£ç·š
[nl]      }
[nl]      else{
[nl]        promptAttack();
[nl]      }
[nl]    }
[nl]  }"
å»–å®‰è±ª,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","[nl]    const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action));
[nl]    return;
[nl]
[nl]","[nl]
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      }
[nl]    }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
å»–å®¶æ¨‚,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","if (msg.includes('online')) {
[nl]      console.log('\nå°æ–¹ç©å®¶åœ¨ç·šï¼ŒéŠæˆ²é–‹å§‹ï¼');
[nl]    }
[nl]    client.publish('battle/action', JSON.stringify(action));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
å¼µæ›œéºŸ,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const BOSS_NAME = 'Boss';
[nl]    // ç™¼é€æ”»æ“Šè¡Œå‹•çµ¦ boss
[nl]    const action = {
[nl]      from : PLAYER_NAME,
[nl]      to : BOSS_NAME,
[nl]      damage : attack_value,
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action));
[nl]    // è¼¸å‡ºæ”»æ“Šè¡Œå‹•
[nl]    console.log(`ç™¼é€æ”»æ“Šè¡Œå‹• : ${JSON.stringify(action)}`);","const BOSS_NAME = 'Boss';
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action'){
[nl]    const info = JSON.parse(msg);
[nl]    if (info.round !== undefined){
[nl]      console.log(`[ ç¬¬ ${info.round} å›åˆ] : Boss å‰©é¤˜è¡€é‡ ${info.boss_hp}`);
[nl]      if (info.boss_hp <= 0){
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      } else {  // Boss é‚„æ´»è‘—
[nl]        console.log(`\nBossä»ç„¶å­˜æ´»!`);
[nl]        setTimeout(()=>{
[nl]          const next_action = {
[nl]            from : PLAYER_NAME,
[nl]            to : BOSS_NAME,
[nl]            damage : attack_value,
[nl]          };
[nl]          client.publish('battle/action', JSON.stringify(next_action));
[nl]          console.log(`\nç¹¼çºŒæ”»æ“Šï¼ ç™¼é€æ”»æ“Šè¡Œå‹• : ${JSON.stringify(next_action)}`);
[nl]        }, 2000);  // 2ç§’å¾Œç¹¼çºŒæ”»æ“Š
[nl]      }
[nl]    }
[nl]  }"
å¼µèŠ¸ç¦,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    try {
[nl]      const roundInfo = JSON.parse(msg);
[nl]
[nl]      if (roundInfo.round !== undefined) {
[nl]        console.log(`[ ç¬¬ ${roundInfo.round} å›åˆ ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]
[nl]        if (roundInfo.boss_hp <= 0) {
[nl]          console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]          client.end();
[nl]        } else {
[nl]          // Boss é‚„æ´»è‘—ï¼Œç¹¼çºŒæ”»æ“Š
[nl]          setTimeout(() => {
[nl]            const action = {
[nl]              from: PLAYER_NAME,
[nl]              to: 'Boss',
[nl]              damage: attack_value
[nl]            };
[nl]            client.publish('battle/action', JSON.stringify(action));
[nl]          }, 1000); // 1ç§’å¾Œå†æ¬¡æ”»æ“Š
[nl]        }
[nl]      }
[nl]    } catch (e) {
[nl]      // å¿½ç•¥é JSON æ ¼å¼çš„è¨Šæ¯
[nl]    }
[nl]  }
[nl]"
æ›¾åšé´»,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","const attack = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attack));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]
[nl]  if (topic === 'battle/action') {
[nl]    try {
[nl]      const data = JSON.parse(msg);
[nl]      if (data.round !== undefined) {
[nl]        console.log(`[ å›åˆ ${data.round} ]: Boss å‰©é¤˜è¡€é‡ ${data.boss_hp}`);
[nl]
[nl]        if (data.boss_hp <= 0) {
[nl]          console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]          client.end();
[nl]        } else {
[nl]          // ç™¼å‹•ä¸‹ä¸€æ¬¡æ”»æ“Š
[nl]          console.log(`${PLAYER_NAME} å†æ¬¡æ”»æ“Š Bossï¼Œé€ æˆ ${attack_value} å‚·å®³`);
[nl]          const nextAttack = {
[nl]            from: PLAYER_NAME,
[nl]            to: 'Boss',
[nl]            damage: attack_value
[nl]          };
[nl]          client.publish('battle/action', JSON.stringify(nextAttack));
[nl]        }
[nl]      }
[nl]    } catch (err) {
[nl]      // å¿½ç•¥é JSON æ ¼å¼è¨Šæ¯
[nl]    }
[nl]  }
[nl]"
æ›¾å¥•èª ,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","let atk = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    }
[nl]    client.publish('battle/action', JSON.stringify(atk));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]      else {
[nl]        let atk = {
[nl]          from: PLAYER_NAME,
[nl]          to: 'Boss',
[nl]          damage: attack_value
[nl]        }
[nl]        client.publish('battle/action', JSON.stringify(atk));
[nl]      }
[nl]    }
[nl]  }"
æå† è“,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    }
[nl]    client.publish('battle/action', JSON.stringify(action));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  
[nl]  if(topic === 'battle/action'){
[nl]    const action = JSON.parse(msg);
[nl]    if(action.round !== undefined){
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]    }
[nl]
[nl]    if(action.boss_hp > 0){
[nl]      console.log(`${PLAYER_NAME} å° Boss ç™¼èµ·æ”»æ“Šï¼Œé€ æˆ ${attack_value} å‚·å®³`);
[nl]      const action = {
[nl]        from: PLAYER_NAME,
[nl]        to: 'Boss',
[nl]        damage: attack_value
[nl]      }
[nl]      client.publish('battle/action', JSON.stringify(action));
[nl]    }
[nl]
[nl]    if(action.boss_hp <= 0){
[nl]      console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]      client.end();
[nl]    }
[nl]  }"
ææ˜•ç’‡,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action));
[nl]    autoAttack();","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    let roundInfo;
[nl]    try {
[nl]      roundInfo = JSON.parse(msg);
[nl]    } catch (err) {
[nl]      return; 
[nl]    }
[nl]
[nl]    
[nl]    if (roundInfo.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]
[nl]      
[nl]      if (roundInfo.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        isBossAlive = false;
[nl]        client.end(); 
[nl]      }
[nl]    }
[nl]  }"
ææ˜•è,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe(""battle/action"");
[nl]  client.subscribe(""battle/online"");","const attackInfo = {
[nl]      to: ""Boss"",
[nl]      from: `${PLAYER_NAME}`,
[nl]      damage: `${attack_value}` 
[nl]    };
[nl]
[nl]    client.publish(""battle/action"", JSON.stringify(attackInfo));
[nl]    return;","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  const action = JSON.parse(msg);
[nl]  if (topic === ""battle/action"") {
[nl]    const bossHealthPoint = action.boss_hp;
[nl]    const round = action.round;
[nl]    if (round != undefined) {
[nl]      console.log(`è¼¸å‡ºå…§å®¹: [ å›åˆ ${round} ]: Boss å‰©é¤˜è¡€é‡ ${bossHealthPoint}`);
[nl]      if (bossHealthPoint <= 0) {
[nl]        console.log(`è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]      }
[nl]      client.end();
[nl]    }
[nl]  }"
ææŸæ¼¢,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attack = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attack));
[nl]","if (topic === 'battle/action') {
[nl]    // è§£æ Boss å‚³ä¾†çš„å›åˆèˆ‡è¡€é‡
[nl]    const action = JSON.parse(msg);
[nl]    const round = action.round;
[nl]    const boss_hp = action.boss_hp;
[nl]
[nl]    if (round !== undefined) {
[nl]      console.log(`[ ç¬¬ ${round} å›åˆ ]: Boss å‰©é¤˜è¡€é‡ ${boss_hp}`);
[nl]    }
[nl]
[nl]    if (boss_hp <= 0) {
[nl]      console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]      client.end(); // çµæŸ MQTT é€£ç·š
[nl]    } else {
[nl]      if (boss_hp > 0) {
[nl]        console.log(`${PLAYER_NAME} å†æ¬¡æ®åŠæ”»æ“Šï¼Œé€ æˆ ${attack_value} å‚·å®³`);
[nl]        const attack = {
[nl]          from: PLAYER_NAME,
[nl]          to: 'Boss',
[nl]          damage: attack_value
[nl]        };
[nl]        client.publish('battle/action', JSON.stringify(attack));
[nl]      }
[nl]    }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
æèƒ¤å¯¬,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attack = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attack));","[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();   //çµæŸ
[nl]      }
[nl]    }
[nl]  }
[nl]  
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
æè‹¥ç¶º,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","[nl]    const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action));    
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]
[nl]  if (topic === 'battle/action') {
[nl]    const status = JSON.parse(msg);
[nl]    if (status.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${status.round} ]: Boss å‰©é¤˜è¡€é‡ ${status.boss_hp}`);
[nl]      if (status.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }  
[nl]"
æé‡‡è±,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","client.publish('battle/action', JSON.stringify({
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    }));
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      }
[nl]    }
[nl]  }"
æ—å† å„€,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","client.publish('battle/action', JSON.stringify({
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    }));","else if (topic === 'battle/action') {
[nl]    // è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡
[nl]    const msg = JSON.parse(message);
[nl]    // è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]    if (msg.round !== undefined) {
[nl]      console.log(`[ å›åˆ${msg.round} ]: Boss å‰©é¤˜è¡€é‡ ${msg.boss_hp}`);
[nl]      if (msg.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      }
[nl]    }
[nl]  }
[nl]  
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
æ—å¡å•Ÿ,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","// 2) å»ºç«‹ action ç‰©ä»¶
[nl]    const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]
[nl]    client.publish('battle/action', JSON.stringify(action));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  if (topic === 'battle/action'){
[nl]    const roundInfo = JSON.parse(msg);
[nl]    const { round, boss_hp } = roundInfo;
[nl]
[nl]    if (typeof round !== 'undefined') {
[nl]      console.log(`[ å›åˆ ${round} ]: Boss å‰©é¤˜è¡€é‡ ${boss_hp}`);
[nl]      if (boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
æ—å­è‘³,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","const BOSS_NAME = 'Boss';
[nl]    const attackMsg = {
[nl]      to: BOSS_NAME,
[nl]      from: PLAYER_NAME,
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackMsg));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  if(topic === 'battle/action'){
[nl]    const roundInfo = JSON.parse(msg);
[nl]    if(roundInfo.round !== undefined){
[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]      if(roundInfo.boss_hp <= 0){
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]      else {
[nl]        console.log(`${PLAYER_NAME} å° Boss å†æ¬¡ç™¼å‹•æ”»æ“Šï¼Œé€ æˆ ${attack_value} å‚·å®³`);
[nl]        const BOSS_NAME = 'Boss';
[nl]        const attackMsg = {
[nl]          to: BOSS_NAME,
[nl]          from: PLAYER_NAME,
[nl]          damage: attack_value
[nl]        };
[nl]        client.publish('battle/action', JSON.stringify(attackMsg));
[nl]      }
[nl]    }
[nl]  }
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
æ—æ˜è¼,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]  // å¯åƒè€ƒ Game.js","const attackInfo = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackInfo));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  if (topic === 'battle/action') {
[nl]  //  è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]    const action = JSON.parse(msg);
[nl]  //  if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]    if (action.round !== undefined) {
[nl]  //  è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]  //  if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]      if (action.boss_hp <= 0) {
[nl]  //  è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]  //  çµæŸ MQTT é€£ç·š
[nl]        client.end();
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]      }
[nl]    }
[nl]  }
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
æ—éŸ‹å®,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","client.publish('battle/action', JSON.stringify({
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    }));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ ç¬¬ ${action.round} å›åˆ ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]      }
[nl]      client.end(); // çµæŸ MQTT é€£ç·š
[nl]    }
[nl]  }"
æŸ¯ä¾‘æ˜“,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","[nl]    const attackAction = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    }
[nl]
[nl]    client.publish('battle/action', JSON.stringify(attackAction));
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    const round = action.round;
[nl]    const hp = action.boss_hp;
[nl]
[nl]    if (round != undefined) {
[nl]      console.log (`[ å›åˆ ${round} ]: Boss å‰©é¤˜è¡€é‡ ${hp}`);
[nl]    }
[nl]
[nl]    if (hp <= 0) {
[nl]      console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]      client.end();
[nl]    }
[nl]  }
[nl]"
æ¥Šå®—å„’,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","let attack = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    }
[nl]    client.publish('battle/action', JSON.stringify(attack));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      if (action.round != 1) {
[nl]        console.log(`${PLAYER_NAME} å° Boss ç™¼èµ·æ”»æ“Šï¼Œé€ æˆ ${attack_value} å‚·å®³`);
[nl]      }
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]      else {
[nl]        let attack = {
[nl]          from: PLAYER_NAME,
[nl]          to: 'Boss',
[nl]          damage: attack_value
[nl]        }
[nl]        client.publish('battle/action', JSON.stringify(attack));
[nl]      }
[nl]    }
[nl]  }"
æ¥Šç‡èŒ¹,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackInfo = {
[nl]      from:PLAYER_NAME,
[nl]      to:'Boss',
[nl]      damage:attack_value,
[nl]    }
[nl]    client.publish('battle/action',JSON.stringify(attackInfo));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  if (topic === 'battle/action') {
[nl]    const response = JSON.parse(msg);
[nl]    const round = response.round;
[nl]    const boss_hp = response.boss_hp;
[nl]    if (round !== undefined) {
[nl]      console.log(`[ å›åˆ ${round} ]: Boss å‰©é¤˜è¡€é‡ ${boss_hp}`);
[nl]      if (boss_hp > 0) {
[nl]        const attackInfo = {
[nl]          from: PLAYER_NAME,
[nl]          to: 'Boss',
[nl]          damage: attack_value,
[nl]        };
[nl]        setTimeout(() => {
[nl]          client.publish('battle/action', JSON.stringify(attackInfo));
[nl]        }, 800);
[nl]      } else {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]  
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
æ²ˆæ€å¦¤,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]
[nl]    client.publish('battle/action', JSON.stringify(action));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      }
[nl]    }
[nl]  }"
ç‹å­ç¿”,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe(""battle/action"");
[nl]  client.subscribe(""battle/online"");","const attackAction = {
[nl]      from: PLAYER_NAME,
[nl]      to: ""Boss"",
[nl]      damage: attack_value,
[nl]    };
[nl]    client.publish(""battle/action"", JSON.stringify(attackAction));","if (topic === ""battle/action"") {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]    client.end(); // ç¢ºä¿æ¯æ¬¡æ‰“å®ŒBosså¯ä»¥ç›´æ¥æ–·ç·š
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
èŠç¾½åª—,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackMessage = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackMessage));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ ç¬¬ ${action.round} å›åˆ ]`);
[nl]      console.log(`Boss å—åˆ° ${PLAYER_NAME} çš„æ”»æ“Šï¼Œæå¤± ${attack_value} HPï¼Œå‰©é¤˜ HPï¼š${action.boss_hp}`);
[nl]      
[nl]      if (action.boss_hp > 0) {
[nl]        // ç¹¼çºŒæ”»æ“Šä¸‹ä¸€å›åˆ
[nl]        const attackMessage = {
[nl]          from: PLAYER_NAME,
[nl]          to: 'Boss',
[nl]          damage: attack_value
[nl]        };
[nl]        client.publish('battle/action', JSON.stringify(attackMessage));
[nl]      } else {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]  
[nl]"
è”¡æ™¯ç´˜,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","client.publish('battle/action', JSON.stringify({from:PLAYER_NAME,to:'Boss',damage:attack_value}));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined){
[nl]      console.log('[ å›åˆ '+action.round+' ]: Boss å‰©é¤˜è¡€é‡ '+action.boss_hp);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      }
[nl]    }
[nl]  }"
è”¡æ±¶ç’‹,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]"
è”¡è© ä¸,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","[nl]    const action = {
[nl]      to : 'Boss',
[nl]      damage : attack_value,
[nl]      from : PLAYER_NAME
[nl]    }
[nl]
[nl]    client.publish('battle/action', JSON.stringify(action));
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]
[nl]  if(topic === 'battle/action'){
[nl]    const roundInfo = JSON.parse(msg);
[nl]    if(roundInfo.round!=null){
[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]      if (roundInfo.boss_hp <= 0) {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); 
[nl]      }
[nl]    }
[nl]  }
[nl]"
è•­åå®¹,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe(""battle/action"");
[nl]  client.subscribe(""battle/online"");
[nl]","const attackInfo = {
[nl]      from: PLAYER_NAME,
[nl]      to: ""Boss"",
[nl]      damage: attack_value,
[nl]    };
[nl]
[nl]    client.publish(""battle/action"", JSON.stringify(attackInfo));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]
[nl]  if (topic === ""battle/action"") {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(
[nl]        `[ ç¬¬ ${action.round} å›åˆ ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`
[nl]      );
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      }
[nl]    }
[nl]  }
[nl]"
è•­å­Ÿæ±,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackMsg = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackMsg));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]
[nl]    if (typeof action.round !== 'undefined' && typeof action.boss_hp !== 'undefined') {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      } else {
[nl]        setTimeout(() => {
[nl]          console.log(`${PLAYER_NAME} å° Boss ç™¼èµ·æ”»æ“Šï¼Œé€ æˆ ${attack_value} å‚·å®³`);
[nl]          const attackMsg = {
[nl]            from: PLAYER_NAME,
[nl]            to: 'Boss',
[nl]            damage: attack_value
[nl]          };
[nl]          client.publish('battle/action', JSON.stringify(attackMsg));
[nl]        }, 1000);
[nl]      }
[nl]    }
[nl]  }"
è¨±æ™¯ç­‘,"client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    }
[nl]    
[nl]    // ç™¼é€æ›´æ–°çµ¦ Bossï¼Œå‘Šè¨´ Boss é€™æ˜¯ç¬¬å¹¾å›åˆä»¥åŠ Boss å‰©é¤˜å¤šå°‘è¡€é‡
[nl]    client.publish('battle/action', JSON.stringify(action));","if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]
[nl]    if (action.boss_hp <= 0) {
[nl]      action.boss_hp = 0; // ç¢ºä¿è¡€é‡ä¸æœƒå°æ–¼ 0
[nl]    }
[nl]    // è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡
[nl]    if (action.round != undefined) {
[nl]      console.log(`[å›åˆ ${action.round}]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]    }
[nl]    
[nl]    if (action.boss_hp <= 0) {
[nl]      console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]      client.end(); // çµæŸ MQTT é€£ç·š
[nl]    }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
è¬å¦æ™,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","client.publish('battle/action', JSON.stringify({
[nl]      to: 'Boss',
[nl]      from: PLAYER_NAME,
[nl]      damage: attack_value
[nl]    }));","client.publish('battle/action', JSON.stringify({
[nl]      to: 'Boss',
[nl]      from: PLAYER_NAME,
[nl]      damage: attack_value
[nl]    }));"
è³´å…ƒæ™º,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackBoss = {
[nl]      damage: attack_value,
[nl]      to: ""Boss"",
[nl]      from: PLAYER_NAME
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackBoss));","if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`)
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`)
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
éƒ­å½¥é ¡,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","[nl]    const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action))
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  if(topic === 'battle/action'){
[nl]    const roundInfo = JSON.parse(msg);
[nl]    if(roundInfo.round != undefined) {
[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]      if(roundInfo.boss_hp <= 0){
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
é‡‘å¨œä¼¶,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]
[nl]  // ì—°ê²°ë˜ë©´ í† í”½ 2ê°œ êµ¬ë…
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');
[nl]","[nl]    const attackInfo = { // ì‹¤ì œ ê³µê²© ë„£ëŠ” ë¶€ë¶„
[nl]      to : 'Boss',
[nl]      damage : attack_value,
[nl]      from : PLAYER_NAME
[nl]    };
[nl]
[nl]    client.publish('battle/action', JSON.stringify(attackInfo))
[nl]
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„) ë³´ìŠ¤ê°€ ë³´ë‚´ì˜¨ ë¼ìš´ë“œ ìˆ˜ë‘ ì²´ë ¥ì„ í•´ì„?
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]
[nl]  if (topic === 'battle/action'){
[nl]    const action = JSON.parse(msg);
[nl]    //console.log(action);
[nl]  
[nl]    if(action.round != undefined){
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`)
[nl]      if(action.boss_hp <= 0){
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`)
[nl]      }
[nl]    }
[nl]
[nl]  }
[nl]"
é™³å¥•åˆ©,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const actionInfo = {
[nl]      from: PLAYER_NAME,
[nl]      to: ""Boss"",
[nl]      damage: attack_value
[nl]    }
[nl]    client.publish(""battle/action"", JSON.stringify(actionInfo));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === ""battle/action"") {
[nl]    const roundInfo = JSON.parse(msg);
[nl]    if (roundInfo.round != undefined) {
[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]      if (roundInfo.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      } else {
[nl]        const actionInfo = {
[nl]          from: PLAYER_NAME,
[nl]          to: ""Boss"",
[nl]          damage: attack_value
[nl]        }
[nl]        client.publish(""battle/action"", JSON.stringify(actionInfo));
[nl]      }
[nl]    }
[nl]  }"
é™³å®¶ç¥¥,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackInfo = {
[nl]      to: 'Boss',
[nl]      from: PLAYER_NAME,
[nl]      damage: attack_value
[nl]    };
[nl]    
[nl]    client.publish('battle/action', JSON.stringify(attackInfo));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]
[nl]  if (topic === 'battle/action') {
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${action.round} ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }
[nl]"
é™³å»ºéŠ˜,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action', (err) => {
[nl]    if(err){
[nl]      console.error('subscribe error:', err);
[nl]    }else{
[nl]      console.log('subscribed to battle/action');
[nl]    }
[nl]  });
[nl]  client.subscribe('battle/online', (err) => {
[nl]    if(err){
[nl]      console.error('subscribe error:', err);
[nl]    }else{
[nl]      console.log('subscribed to battle/online');
[nl]    }
[nl]  });","const action={
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action',JSON.stringify(action));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if(topic==='battle/action'){
[nl]    const roundInfo = JSON.parse(msg);
[nl]    if(roundInfo.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`)
[nl]      if(roundInfo.boss_hp<=0){
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•—ï¼ï¼ï¼`)
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }"
é™³æ˜¶å®‰,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe([""battle/action"", ""battle/online""]);","console.log(`Boss åœ¨ç·šï¼ŒéŠæˆ²é–‹å§‹ï¼`);
[nl]    const attack = {
[nl]      to: ""Boss"",
[nl]      damage: attack_value,
[nl]      from: PLAYER_NAME,
[nl]    };
[nl]    client.publish(""battle/action"", JSON.stringify(attack));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === ""battle/action"") {
[nl]    try {
[nl]      const action = JSON.parse(msg);
[nl]      if (action.round !== undefined) {
[nl]        if (action.boss_hp <= 0) {
[nl]          action.boss_hp = 0;
[nl]        }
[nl]
[nl]        console.log(
[nl]          `[ ç¬¬ ${action.round} å›åˆ ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`
[nl]        );
[nl]
[nl]        if (action.boss_hp <= 0) {
[nl]          console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]          client.end();
[nl]          return;
[nl]        }
[nl]
[nl]        // æŒçºŒæ”»æ“Šç›´åˆ°å‹åˆ©
[nl]        const nextAttack = {
[nl]          to: ""Boss"",
[nl]          damage: attack_value,
[nl]          from: PLAYER_NAME,
[nl]        };
[nl]        client.publish(""battle/action"", JSON.stringify(nextAttack));
[nl]      }
[nl]    } catch (e) {
[nl]      console.error(""è¨Šæ¯è§£æéŒ¯èª¤:"", e);
[nl]    }
[nl]  }"
é™³æŸæ·µ,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]
[nl]  // ç™¼å¸ƒç·šä¸Šè¨Šæ¯
[nl]  client.publish('battle/online', `online:${PLAYER_NAME}`);
[nl]
[nl]  // è¨‚é–± battle/action
[nl]  client.subscribe('battle/action');
[nl]
[nl]  // ç™¼å‹•æ”»æ“Š
[nl]  const attack = {
[nl]    to: 'Boss',
[nl]    from: PLAYER_NAME,
[nl]    damage: attack_value
[nl]  };
[nl]
[nl]  // ç™¼å¸ƒæ”»æ“Šè¨Šæ¯çµ¦ Boss
[nl]  client.publish('battle/action', JSON.stringify(attack));
[nl]",return;,"[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    // ç¬¬äºŒéšæ®µï¼šè™•ç† Boss å›å‚³è¡€é‡èˆ‡å›åˆæ•¸
[nl]    const data = JSON.parse(msg);
[nl]    if (data.round !== undefined) {
[nl]      console.log(`\n[ å›åˆ ${data.round} ]: Boss å‰©é¤˜è¡€é‡ ${data.boss_hp}`);
[nl]      if (data.boss_hp <= 0) {
[nl]        console.log(`ğŸ‰ğŸ‰ æ­å–œ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      } else {
[nl]        // å†æ¬¡ç™¼å‹•æ”»æ“Š
[nl]        const attack = {
[nl]          to: 'Boss',
[nl]          from: PLAYER_NAME,
[nl]          damage: attack_value
[nl]        };
[nl]        client.publish('battle/action', JSON.stringify(attack));
[nl]      }
[nl]    }
[nl]  }"
é™³æ¥·ç’¿,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action')
[nl]  client.subscribe('battle/online')","const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value,
[nl]    }
[nl]
[nl]    client.publish('battle/action', JSON.stringify(action))","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  if (topic === 'battle/action') {
[nl]    const roundInfo = JSON.parse(msg)
[nl]
[nl]    if (roundInfo.round !== undefined) {
[nl]      console.log(
[nl]        `[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp} ]`
[nl]      )
[nl]
[nl]      if (roundInfo.boss_hp <= 0) {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`)
[nl]        client.end() // çµæŸé€£ç·š
[nl]      } else {
[nl]        setTimeout(() => {
[nl]          client.publish('battle/online', JSON.stringify(action))
[nl]        }, 1000)
[nl]      }
[nl]    }
[nl]  }
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
é™³ç‚«éœ–,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action));
[nl]    return;","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  if (topic === 'battle/action') {
[nl]    const info = JSON.parse(msg);
[nl]    if (info.round !== undefined) {
[nl]      console.log(`[ ç¬¬ ${info.round} å›åˆ ]`);
[nl]      console.log(`Boss å—åˆ° ${PLAYER_NAME} çš„æ”»æ“Šï¼Œæå¤± ${attack_value} HPï¼Œå‰©é¤˜ HPï¼š${info.boss_hp}`);
[nl]  
[nl]      if (info.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•—!!!`);
[nl]        client.end();
[nl]      } else {
[nl]        const nextAttack = {
[nl]          from: PLAYER_NAME,
[nl]          to: 'Boss',
[nl]          damage: attack_value
[nl]        };
[nl]        client.publish('battle/action', JSON.stringify(nextAttack));
[nl]      }
[nl]    }
[nl]  }
[nl]  
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
é™³ç«£å“²,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackMsg = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackMsg));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    // æ¥æ”¶ç”± Boss ç™¼å‡ºçš„å›åˆè³‡è¨Š (å›åˆæ•¸èˆ‡å‰©é¤˜è¡€é‡)
[nl]    let data;
[nl]    try {
[nl]      data = JSON.parse(msg);
[nl]    } catch(err) {
[nl]      console.error('ç„¡æ³•è§£æå›å‚³çš„è¨Šæ¯:', err);
[nl]      return;
[nl]    }
[nl]    // æª¢æŸ¥å›å‚³çš„è¨Šæ¯ä¸­æ˜¯å¦åŒ…å«å›åˆæ•¸èˆ‡ Boss å‰©é¤˜è¡€é‡çš„è³‡è¨Š
[nl]    if (data.round !== undefined && data.boss_hp !== undefined) {
[nl]      console.log(`[ å›åˆ ${data.round} ]: Boss å‰©é¤˜è¡€é‡ ${data.boss_hp}`);
[nl]      
[nl]      // è‹¥ Boss è¡€é‡å°æ–¼ç­‰æ–¼ 0ï¼Œå‰‡é¡¯ç¤ºæ“Šæ•—è¨Šæ¯ä¸¦çµæŸé€£ç·š
[nl]      if (data.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }"
é™³è‰¯éˆº,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe(['battle/action', 'battle/online'], function (err) {
[nl]    if (err) {
[nl]      console.log('Subscription error:', err);
[nl]    } else {
[nl]      console.log('æˆåŠŸè¨‚é–±è‡³ä¸»é¡Œ battle/action, battle/online');
[nl]    }
[nl]  });","const attackStatus = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackStatus));
[nl]","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  if (topic === 'battle/action'){
[nl]    const action = JSON.parse(msg);
[nl]
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ ç¬¬ ${action.round} å›åˆ ]`);
[nl]      console.log(`Boss å—åˆ° ${PLAYER_NAME}çš„æ”»æ“Š ,æå¤±${attack_value}HP ,å‰©é¤˜HP: ${action.boss_hp}`);
[nl]      
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      }
[nl]      else {
[nl]        // è‹¥ Boss æœªè¢«æ“Šæ•—ï¼Œç¹¼çºŒä¸‹ä¸€å›åˆæ”»æ“Š
[nl]        setTimeout(() => {
[nl]          round=action.round;
[nl]          round++;
[nl]          const nextAttack = {
[nl]            from: PLAYER_NAME,
[nl]            to: 'Boss',
[nl]            damage: attack_value
[nl]          };
[nl]          client.publish('battle/action', JSON.stringify(nextAttack));
[nl]        }, 1000);  // é–“éš”
[nl]      }
[nl]    }
[nl]
[nl]  }
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
é™³è‹¥åº­,"client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","client.publish('battle/action', JSON.stringify({
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    }));","if (topic == ""battle/action"") {
[nl]    const roundInfo = JSON.parse(msg);
[nl]      const round = roundInfo.round;
[nl]      const boss_hp = roundInfo.boss_hp;
[nl]
[nl]      if (round !== undefined && boss_hp !== undefined) {
[nl]        console.log(`[ ç¬¬ ${round} å›åˆ ]`);
[nl]        console.log(`Boss å—åˆ° Player çš„æ”»æ“Šï¼Œæå¤± ${attack_value} HPï¼Œå‰©é¤˜ HPï¼š${boss_hp}`);
[nl]        
[nl]        if (boss_hp <= 0) {
[nl]          console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]          client.end(); // çµæŸ MQTT é€£ç·š
[nl]        }
[nl]      }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
é™³è© ,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attack = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attack));","if(topic === 'battle/action'){
[nl]    const action = JSON.parse(msg);
[nl]    if (action.round !== undefined) {
[nl]      console.log(`[ ç¬¬ ${action.round} å›åˆ ]: Boss å‰©é¤˜è¡€é‡ ${action.boss_hp}`);
[nl]      if (action.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end(); // çµæŸ MQTT é€£ç·š
[nl]      }
[nl]    }
[nl]  }
[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
é™³é®æˆ,"[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online'); 
[nl]","const attackAction = {
[nl]      to: 'Boss',         
[nl]      from: PLAYER_NAME,  
[nl]      damage: attack_value 
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackAction));","if (topic === 'battle/action') { 
[nl]    try {
[nl]      const receivedData = JSON.parse(msg); // ä½¿ç”¨æ›´é€šç”¨çš„åç¨±
[nl]
[nl]      // æª¢æŸ¥æ˜¯å¦æ˜¯ Boss çš„ç‹€æ…‹æ›´æ–°è¨Šæ¯ (åŒ…å« round å’Œ boss_hp)
[nl]      if (receivedData.round !== undefined && receivedData.boss_hp !== undefined) {
[nl]        // === è®Šæ•¸å®šç¾© ===
[nl]        const currentRound = receivedData.round;
[nl]        const bossCurrentHp = receivedData.boss_hp;
[nl]
[nl]        // === ä½¿ç”¨è®Šæ•¸çš„ç¨‹å¼ç¢¼ï¼Œç¾åœ¨ä½æ–¼æ­£ç¢ºçš„ä½œç”¨åŸŸå…§ ===
[nl]        console.log(`[ ç¬¬ ${currentRound} å›åˆ ]: Boss å‰©é¤˜è¡€é‡ ${bossCurrentHp}`);
[nl]
[nl]        if (bossCurrentHp <= 0) {
[nl]          // Boss è¢«æ“Šæ•—
[nl]          console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]          client.end(); // çµæŸ MQTT é€£ç·š
[nl]        } else {
[nl]          // Boss é‚„æ´»è‘—ï¼Œç™¼å‹•ä¸‹ä¸€æ¬¡æ”»æ“Š
[nl]          console.log(`\n${PLAYER_NAME} å° Boss ç™¼èµ·æ”»æ“Šï¼Œé€ æˆ ${attack_value} å‚·å®³`);
[nl]          const nextAttackAction = {
[nl]            to: 'Boss',
[nl]            from: PLAYER_NAME,
[nl]            damage: attack_value
[nl]          };
[nl]          client.publish('battle/action', JSON.stringify(nextAttackAction));
[nl]        }
[nl]        // === ä½¿ç”¨è®Šæ•¸çš„ç¨‹å¼ç¢¼çµæŸ ===
[nl]
[nl]      } 
[nl]      // else: å¦‚æœæ”¶åˆ°çš„è¨Šæ¯ä¸æ˜¯ Boss çš„ç‹€æ…‹æ›´æ–°æ ¼å¼ (ä¾‹å¦‚ï¼Œæ˜¯è‡ªå·±çš„æ”»æ“Šå›é¡¯)ï¼Œå‰‡å¿½ç•¥å®ƒã€‚
[nl]      // ä½ ä¹Ÿå¯ä»¥åœ¨é€™è£¡åŠ å€‹ console.log ä¾†è§€å¯Ÿæ”¶åˆ°äº†ä»€éº¼éé æœŸè¨Šæ¯ï¼š
[nl]      // else {
[nl]      //   console.log(""æ”¶åˆ°é Boss ç‹€æ…‹æ›´æ–°è¨Šæ¯:"", receivedData);
[nl]      // }
[nl]
[nl]    } catch (error) {
[nl]      // JSON è§£æå¤±æ•—æˆ–å…¶ä»–è™•ç†éŒ¯èª¤
[nl]      console.error(""è™•ç† 'battle/action' è¨Šæ¯æ™‚ç™¼ç”ŸéŒ¯èª¤:"", msg, error); 
[nl]    }
[nl]  }"
é™³é¼å¿ƒ,"// 1. é€£ç·šè‡³ MQTT broker çš„äº‹ä»¶è™•ç†
[nl]client.on('connect', () => {
[nl]  console.log(`${PLAYER_ID} å·²é€£ç·šè‡³ MQTT broker\n`);
[nl]  
[nl]  // è¨‚é–± Boss ä¸Šç·šé€šçŸ¥
[nl]  client.subscribe(TOPICS.ONLINE);
[nl]  
[nl]  // è¨‚é–± Boss ç‹€æ…‹æ›´æ–°
[nl]  client.subscribe(TOPICS.STATUS);
[nl]  
[nl]  // ç™¼å¸ƒç©å®¶ä¸Šç·šé€šçŸ¥
[nl]  client.publish(TOPICS.ONLINE, JSON.stringify({
[nl]    id: PLAYER_ID,
[nl]    online: true
[nl]  }));
[nl]  
[nl]  // è®“æˆ‘å€‘å˜—è©¦ä¸»å‹•ç™¼é€ä¸€æ¬¡æ”»æ“Š
[nl]  setTimeout(attackBoss, 2000);
[nl]});
[nl]
[nl]// 2. æ¥æ”¶è¨Šæ¯çš„äº‹ä»¶è™•ç†
[nl]client.on('message', (topic, message) => {
[nl]  const messageStr = message.toString();
[nl]  
[nl]  // è™•ç† Boss ä¸Šç·š/é›¢ç·š
[nl]  if (topic === TOPICS.ONLINE) {
[nl]    const data = JSON.parse(messageStr);
[nl]    
[nl]    // å¿½ç•¥è‡ªå·±çš„ä¸Šç·šæ¶ˆæ¯
[nl]    if (data.id === PLAYER_ID) return;
[nl]    
[nl]    // å¦‚æœ Boss ä¸Šç·šï¼Œé–‹å§‹æ”»æ“Š
[nl]    if (data.id === 'Boss' && data.online && !isBossOnline) {
[nl]      console.log('å°æ–¹ç©å®¶åœ¨ç·šï¼ŒéŠæˆ²é–‹å§‹ï¼');
[nl]      isBossOnline = true;
[nl]      attackBoss();
[nl]    }
[nl]  }
[nl]  
[nl]  // è™•ç† Boss å›æ‡‰çš„ç‹€æ…‹æ›´æ–°
[nl]  if (topic === TOPICS.STATUS) {
[nl]    const status = JSON.parse(messageStr);
[nl]    
[nl]    // é¡¯ç¤ºç•¶å‰å›åˆè³‡è¨Š
[nl]    console.log(`[ ç¬¬ ${status.round} å›åˆ ]`);
[nl]    console.log(`Boss å—åˆ° ${status.attacker} çš„æ”»æ“Šï¼Œæå¤± ${status.damage} HPï¼Œå‰©é¤˜ HPï¼š${status.remainingHealth}`);
[nl]    
[nl]    // æª¢æŸ¥æ˜¯å¦æ“Šæ•— Boss
[nl]    if (status.gameOver) {
[nl]      console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${status.attacker} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]      isGameOver = true;
[nl]    } else {
[nl]      // ç¹¼çºŒæ”»æ“Š
[nl]      setTimeout(attackBoss, 500);
[nl]    }
[nl]  }
[nl]});
[nl]
[nl]// 3. æ”»æ“Š Boss çš„å‡½æ•¸
[nl]function attackBoss() {
[nl]  // å¦‚æœéŠæˆ²å·²çµæŸï¼Œä¸å†æ”»æ“Š
[nl]  if (isGameOver) return;
[nl]  
[nl]  // ç™¼é€æ”»æ“Šå‹•ä½œ
[nl]  const attackMsg = {
[nl]    id: PLAYER_ID,
[nl]    action: 'attack'
[nl]  };
[nl]  
[nl]  client.publish(TOPICS.ACTION, JSON.stringify(attackMsg));
[nl]}",,
é™¸äººç‘‹,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const roundInfo = JSON.parse(msg);
[nl]    if (roundInfo.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]      if (roundInfo.boss_hp <= 0) {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]      // å¦‚æœ Boss é‚„æ´»è‘—å‰‡ç¹¼çºŒæ”»æ“Šã€‚è¨»è§£æ²’èªªåªæœƒæ‰“ä¸€è¼ªé˜¿
[nl]      else {
[nl]        const nextAction = {
[nl]          from: PLAYER_NAME,
[nl]          to: 'Boss',
[nl]          damage: attack_value
[nl]          };
[nl]        client.publish('battle/action', JSON.stringify(nextAction));
[nl]      }
[nl]    }
[nl]  }"
é¡è–å³°,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","// ç™¼é€æ”»æ“Šè¨Šæ¯
[nl]    const attack = {
[nl]      from: PLAYER_NAME,to: 'Boss',damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attack));","if (topic === 'battle/action') {
[nl]    const roundInfo = JSON.parse(msg);
[nl]    if (roundInfo.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]      if (roundInfo.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]    }
[nl]  }"
é»ƒç§‘å¯¯,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  
[nl]  client.subscribe('battle/action')
[nl]  client.subscribe('battle/online')",// æ”»æ“Šé‚è¼¯å·²ç§»è‡³ sendAttack() å‡½æ•¸,"if (topic === 'battle/action') {
[nl]    try {
[nl]      // è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡
[nl]      const roundInfo = JSON.parse(msg);
[nl]      
[nl]      if (roundInfo.round !== undefined) {
[nl]        console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]        
[nl]        if (roundInfo.boss_hp <= 0) {
[nl]          console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]          client.end(); // çµæŸ MQTT é€£ç·š
[nl]        } else {
[nl]          // Boss é‚„æ´»è‘—ï¼Œç¹¼çºŒæ”»æ“Š
[nl]          setTimeout(sendAttack, 1000); 
[nl]        }
[nl]      }
[nl]    } catch (error) {
[nl]      console.error('è§£æ Boss å›æ‡‰ç™¼ç”ŸéŒ¯èª¤:', error);
[nl]    }
[nl]  }"
é»ƒç­ ,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const payload = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value,
[nl]    };
[nl]
[nl]    client.publish('battle/action', JSON.stringify(payload));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    const data = JSON.parse(msg);
[nl]
[nl]    if (typeof data.round !== 'undefined') {
[nl]      console.log(`[ å›åˆ ${data.round} ]: Boss å‰©é¤˜è¡€é‡ ${data.boss_hp}`);
[nl]
[nl]      if (data.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      } else {
[nl]        const payload = {
[nl]          from: PLAYER_NAME,
[nl]          to: 'Boss',
[nl]          damage: attack_value,
[nl]        };
[nl]        client.publish('battle/action', JSON.stringify(payload));
[nl]      }
[nl]    }
[nl]  }"
é»ƒèŒ‚å‹›,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackMessage = {
[nl]      to: 'Boss',           
[nl]      from: PLAYER_NAME,    
[nl]      damage: attack_value 
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackMessage));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]
[nl]  if (topic === 'battle/action') {
[nl]    try {
[nl]      const action = JSON.parse(msg);
[nl]      const { round, boss_hp } = action;
[nl]      if (round !== undefined) {
[nl]        console.log(`[ ç¬¬ ${round} å›åˆ ]: Boss å‰©é¤˜è¡€é‡ ${boss_hp}`);
[nl]        
[nl]        if (boss_hp <= 0) {
[nl]          console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]          client.end(); // çµæŸ MQTT é€£ç·š
[nl]        }
[nl]      }
[nl]    } catch (error) {
[nl]      console.error('éŒ¯èª¤ï¼šç„¡æ³•è§£æ action è¨Šæ¯å…§å®¹', error);
[nl]    }
[nl]  }"
é»ƒè“‰å®¹,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attackMsg = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(attackMsg));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]  if (topic === 'battle/action') {
[nl]    let data;
[nl]    try {
[nl]      data = JSON.parse(msg);
[nl]    } catch (_) {
[nl]      return;
[nl]    }
[nl]
[nl]    if (data && data.round !== undefined) {
[nl]      console.log(`[ å›åˆ ${data.round} ]: Boss å‰©é¤˜è¡€é‡ ${data.boss_hp}`);
[nl]
[nl]      if (data.boss_hp <= 0) {
[nl]        console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      } else {
[nl]        // ä¸‹ä¸€å›åˆå†æ”»æ“Š
[nl]        const attackMsg = {
[nl]          from: PLAYER_NAME,
[nl]          to: 'Boss',
[nl]          damage: attack_value
[nl]        };
[nl]        client.publish('battle/action', JSON.stringify(attackMsg));
[nl]      }
[nl]    }
[nl]  }"
é»ƒé¡¥éœ†,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","// çµ„æˆä¸€å€‹ JSON æ ¼å¼çš„æ”»æ“Šè¨Šæ¯ï¼ŒåŒ…å«æ”»æ“Šè€…ã€å°è±¡åŠæ”»æ“Šå‚·å®³ï¼Œä¸¦ç™¼é€çµ¦ 'battle/action'
[nl]    const action = {
[nl]      from: PLAYER_NAME,
[nl]      to: 'Boss',
[nl]      damage: attack_value
[nl]    };
[nl]    client.publish('battle/action', JSON.stringify(action));","// ç•¶æ”¶åˆ° 'battle/action' ä¸»é¡Œçš„è¨Šæ¯æ™‚ï¼Œè§£æ Boss å›å‚³çš„å›åˆæ•¸èˆ‡å‰©é¤˜ HPï¼Œ
[nl]  // ä¸¦ä¾ç…§å›å‚³è³‡æ–™è¼¸å‡ºç‹€æ…‹ï¼›è‹¥ Boss HP <= 0ï¼Œå‰‡çµæŸé€£ç·šã€‚
[nl]  if (topic === 'battle/action') {
[nl]    try {
[nl]      const roundInfo = JSON.parse(msg);
[nl]      // æ”¶åˆ°å›åˆè³‡è¨Šæ™‚æ‰é€²è¡Œå¾ŒçºŒåˆ¤æ–·
[nl]      if (roundInfo.round !== undefined) {
[nl]        console.log(`[ å›åˆ ${roundInfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundInfo.boss_hp}`);
[nl]        if (roundInfo.boss_hp <= 0) {
[nl]          console.log(`æ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]          //client.end();
[nl]        } else {
[nl]          // Boss é‚„æœªè¢«æ“Šæ•—ï¼Œç¹¼çºŒç™¼å‹•ä¸‹ä¸€æ¬¡æ”»æ“Š
[nl]          console.log(`${PLAYER_NAME} å° Boss ç™¼èµ·æ”»æ“Šï¼Œé€ æˆ ${attack_value} å‚·å®³`);
[nl]          const action = {
[nl]            from: PLAYER_NAME,
[nl]            to: 'Boss',
[nl]            damage: attack_value
[nl]          };
[nl]          client.publish('battle/action', JSON.stringify(action));
[nl]        }
[nl]      }
[nl]    } catch (e) {
[nl]      console.error('ç„¡æ³•è§£æè¨Šæ¯:', msg);
[nl]    }
[nl]  }"
é¾”ä¿æ¬,"// è¨‚é–±ä¸»é¡Œ 'battle/action' å’Œ 'battle/online'
[nl]  // å¯åƒè€ƒ Game.js
[nl]  client.subscribe('battle/action');
[nl]  client.subscribe('battle/online');","const attack = {
[nl]      from:PLAYER_NAME,
[nl]      to:'Boss',
[nl]      damage:attack_value
[nl]    };
[nl]    client.publish('battle/action',JSON.stringify(attack));","[nl]  // ç¨‹å¼é‚è¼¯: (è¼”åŠ©ç”¨)
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  //  if ä¸»é¡Œæ˜¯ battle/action :  (å¯åƒè€ƒ player.js ä¸­ battle/online æ€éº¼åˆ¤æ–·çš„)
[nl]  //    è§£æ Boss å‚³ä¾†çš„å›åˆæ•¸èˆ‡è¡€é‡ (è«‹åƒè€ƒ Game.js ä¸­ çš„ action JSON è§£æï¼Œæ€éº¼å¯¦ä½œçš„)
[nl]  //    if å‚³å›ä¾†çš„å›åˆæ•¸ä¸ç­‰æ–¼ undefined :
[nl]  //      è¼¸å‡ºå…§å®¹: [ å›åˆ ${å›åˆæ•¸} ]: Boss å‰©é¤˜è¡€é‡ ${è¡€é‡}
[nl]  //      if Boss å‰©é¤˜è¡€é‡ <= 0 :
[nl]  //        è¼¸å‡ºå…§å®¹: æ­å–œğŸ‰ğŸ‰ ~~~ ${ç©å®¶åç¨±} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!
[nl]  //        çµæŸ MQTT é€£ç·š
[nl]  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[nl]  if (topic === 'battle/action') {
[nl]    const roundinfo = JSON.parse(msg);
[nl]    if (roundinfo.round !== undefined ) {
[nl]      console.log(`\n[ å›åˆ ${roundinfo.round} ]: Boss å‰©é¤˜è¡€é‡ ${roundinfo.boss_hp}`);
[nl]      if (roundinfo.boss_hp <= 0) {
[nl]        console.log(`\næ­å–œğŸ‰ğŸ‰ ~~~ ${PLAYER_NAME} æ”»æ“ŠæˆåŠŸï¼ŒBoss è¢«æ“Šæ•— !!!`);
[nl]        client.end();
[nl]      }
[nl]      else {
[nl]        client.publish('battle/online', `contiune`);
[nl]      }
[nl]    }
[nl]  }
[nl]  // éƒ¨åˆ†å…§å®¹ï¼Œå¯åƒè€ƒ Game.js ä¸­çš„ç¨‹å¼ç¢¼
[nl]"
